\section{概要}

多くのCPUは、投機実行を悪用するSpectre攻撃に対して脆弱である。この脆弱性に対処するため、直列化命令の挿入やSpeculative Load Hardening (SLH) などの防御手法が提案されている。しかし、これらの手法をすべての条件分岐命令に適用し投機実行を完全に抑制する場合、非常に大きな実行時オーバーヘッドが発生するという問題がある。
そこで、プログラム内のSpectre攻撃に脆弱なコード片（Spectre Gadget）を特定し、部分的に投機的実行を抑制することで、実行時オーバーヘッドを削減する手法が提案されている。このアプローチでは、最低限のオーバーヘッドでSpectre攻撃を防御するために、高精度かつ効率的にGadgetを特定できるツールが求められる。

既存の記号実行を用いたGadgetの検出手法は、通常の実行パスに加え、投機的実行パスも探索する必要があるため、状態空間が増大し、大規模なプログラムに対してスケールしない問題がある。一方でファジングを用いたGadgetの検出手法は、カバレッジ不足により一部の状態が探索されずGadgetが見逃される可能性がある。そこで本論文では、記号実行とファジングの解析手法を組み合わせることで、スケーラビリティと精度の両立を目指すSpectre Gadget の検出手法を提案する。記号実行とファジングにはそれぞれ利点と欠点が存在するが、両者を組み合わせることで、それぞれの欠点を補完し合い、スケーラビリティと精度を両立できると考える。記号実行では、ネストされた分岐予測ミスの回数を制限することで、投機的状態の探索範囲を縮小し、記号実行のスケーラビリティを向上させる。ファジングでは、記号実行で得られた解析結果を利用し、記号実行で探索されなかった状態を効率的に探索する。

提案手法のプロトタイプを実装し、広く利用されている暗号化ライブラリであるOpenSSLからいくつかのプログラムを選択して実験を行った。その結果、いくつかの検体において記号実行のスケーラビリティが大幅に向上することを確認した。また、解析全体としては、既存手法よりも効率的にSpectre Gadgetが検出された検体を確認した。

